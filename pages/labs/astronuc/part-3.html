
<!DOCTYPE html>


<html lang="en" data-content_root="../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Part 3: Investigate the supernovae &#8212; cogsworth school</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../../_static/new_font.css?v=454821b3" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom.css?v=f14441e9" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../../_static/doctools.js?v=fd6eb6e6"></script>
    <script src="../../../_static/sphinx_highlight.js?v=6ffebe34"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script src="../../../_static/design-tabs.js?v=f930bc37"></script>
    <script>window.MathJax = {"tex": {"tags": "ams", "useLabelIds": true}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@4/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'pages/labs/astronuc/part-3';</script>
    <link rel="icon" href="../../../_static/cog.ico"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Part 4: Varying our assumptions" href="part-4.html" />
    <link rel="prev" title="Part 2: Identifying specific objects in the population" href="part-2.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/cogsworth-logo.png" class="logo__image only-light" alt=""/>
    <script>document.write(`<img src="../../../_static/cogsworth-logo-darkmode.png" class="logo__image only-dark" alt=""/>`);</script>
  
  
    <p class="title logo__title">cogsworth school</p>
  
</a></div>
        <div class="sidebar-primary-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/TomWagg/cogsworth" title="cogsworth repo" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">cogsworth repo</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://cogsworth.readthedocs.io/" title="cogsworth docs" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-solid fa-book fa-lg" aria-hidden="true"></i>
            <span class="sr-only">cogsworth docs</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/TomWagg/cogsworth/issues/new?template=question.md" title="ask a question" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-solid fa-comment-dots fa-lg" aria-hidden="true"></i>
            <span class="sr-only">ask a question</span></a>
        </li>
</ul></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Background</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../background/start.html">Preparing for the labs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../background/reference.html">Useful reference material</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../background/output.html">Understand your output</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Labs</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../astronuc-index.html">AstroNuc 2026</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="part-1.html">Part 1: Creating your first population</a></li>
<li class="toctree-l2"><a class="reference internal" href="part-2.html">Part 2: Identifying specific objects in the population</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Part 3: Investigate the supernovae</a></li>
<li class="toctree-l2"><a class="reference internal" href="part-4.html">Part 4: Varying our assumptions</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">



<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Part 3: Investigate the supernovae</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#demo">Demo</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-population-with-lots-of-massive-stars">Create a population with lots of massive stars</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#find-the-supernovae">Find the supernovae</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inspect-supernova-timing-in-the-frame-of-the-binary">Inspect supernova timing in the frame of the binary</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-the-timing-on-galactic-timescales">Compute the timing on Galactic timescales</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#locate-the-supernovae-in-the-galaxy">Locate the supernovae in the galaxy</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tasks">Tasks</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="part-3-investigate-the-supernovae">
<h1>Part 3: Investigate the supernovae<a class="headerlink" href="#part-3-investigate-the-supernovae" title="Link to this heading">#</a></h1>
<p>Now that we can simulate Populations of binaries and identify specific subpopulations, it’s time to track down those supernovae! I’ll start with a demo of how to do this and then you can do the same thing with common-envelope events.</p>
<section id="demo">
<h2>Demo<a class="headerlink" href="#demo" title="Link to this heading">#</a></h2>
<section id="create-a-population-with-lots-of-massive-stars">
<h3>Create a population with lots of massive stars<a class="headerlink" href="#create-a-population-with-lots-of-massive-stars" title="Link to this heading">#</a></h3>
<p>First things first, let’s make a slightly different population, which preferentially samples higher mass binaries. This will give us more supernovae to work with.</p>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Note that this population still stores the total mass in binaries and singles stars required to create this population (in the <a class="reference external" href="https://cogsworth.readthedocs.io/en/latest/api/cogsworth.pop.Population.html#cogsworth.pop.Population.mass_binaries" title="(in cogsworth)"><code class="xref py py-attr docutils literal notranslate"><span class="pre">mass_binaries</span></code></a> and <a class="reference external" href="https://cogsworth.readthedocs.io/en/latest/api/cogsworth.pop.Population.html#cogsworth.pop.Population.mass_singles" title="(in cogsworth)"><code class="xref py py-attr docutils literal notranslate"><span class="pre">mass_singles</span></code></a> attributes). So you can renormalise without worrying that you’ve preferentially sampled from the IMF.</p>
</aside>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">cogsworth</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">cogsworth</span><span class="o">.</span><span class="n">pop</span><span class="o">.</span><span class="n">Population</span><span class="p">(</span>
    <span class="n">n_binaries</span><span class="o">=</span><span class="mi">10_000</span><span class="p">,</span>
    <span class="n">use_default_BSE_settings</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">final_kstar1</span><span class="o">=</span><span class="p">[</span><span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">],</span>          <span class="c1"># aim to sample systems that produce a NS/BH</span>
    <span class="n">final_kstar2</span><span class="o">=</span><span class="p">[</span><span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">],</span>          <span class="c1"># same for secondary star</span>
<span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">create_population</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="find-the-supernovae">
<h3>Find the supernovae<a class="headerlink" href="#find-the-supernovae" title="Link to this heading">#</a></h3>
<p>Our goal here is to find the times at which supernovae occur in our population. The table of interest in this case is the <code class="docutils literal notranslate"><span class="pre">bpp</span></code> table, which tracks the properties of each binary at every “important” time step in the simulation.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The <a class="reference internal" href="../../background/output.html#output"><span class="std std-ref">output documentation</span></a> has a detailed description of (a) what different <code class="docutils literal notranslate"><span class="pre">evol_type</span></code> and <code class="docutils literal notranslate"><span class="pre">kstar</span></code> values mean and (b) definitions of every column in the <code class="docutils literal notranslate"><span class="pre">bpp</span></code> table. I recommend keeping this documentation open as you work through this part of the lab.</p>
</div>
<p>Supernovae are indicated by an <code class="docutils literal notranslate"><span class="pre">evol_type</span></code> value of 15 for primary stars and 16 for secondary stars. Any row with this value corresponds to a supernova. Let’s find these rows!</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># find the rows at which a supernova occurs</span>
<span class="n">primary_sn</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">bpp</span><span class="p">[</span><span class="s2">&quot;evol_type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">15</span>
<span class="n">secondary_sn</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">bpp</span><span class="p">[</span><span class="s2">&quot;evol_type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">16</span>
<span class="n">sn_mask</span> <span class="o">=</span> <span class="n">primary_sn</span> <span class="o">|</span> <span class="n">secondary_sn</span>

<span class="c1"># mask the rows in the Pandas DataFrame</span>
<span class="n">primary_sn_rows</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">bpp</span><span class="p">[</span><span class="n">primary_sn</span><span class="p">]</span>
<span class="n">secondary_sn_rows</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">bpp</span><span class="p">[</span><span class="n">secondary_sn</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="inspect-supernova-timing-in-the-frame-of-the-binary">
<h3>Inspect supernova timing in the frame of the binary<a class="headerlink" href="#inspect-supernova-timing-in-the-frame-of-the-binary" title="Link to this heading">#</a></h3>
<p>We can now take a look at the distribution of times at which these events occur.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># use the same bins for both histograms to make it easier to compare</span>
<span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="c1"># plot both as density distributions</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">bpp</span><span class="p">[</span><span class="s2">&quot;tphys&quot;</span><span class="p">][</span><span class="n">primary_sn</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Primary SN&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">bpp</span><span class="p">[</span><span class="s2">&quot;tphys&quot;</span><span class="p">][</span><span class="n">secondary_sn</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Secondary SN&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
    <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Time in frame of binary, $t_b$ [Myr]&quot;</span><span class="p">,</span>
    <span class="n">ylabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;${\rm}dN/{\rm d}t_b$&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-center" id="id1">
<a class="reference internal image-reference" href="../../../_images/sn_times_binary.png"><img alt="Histogram of supernova times in the frame of the binary" src="../../../_images/sn_times_binary.png" style="width: 80%;" />
</a>
<figcaption>
<p><span class="caption-text">Distribution of supernova times in the frame of the binary, with primary and secondary supernovae shown separately.</span><a class="headerlink" href="#id1" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>It’s important to note here that these times are in the frame of the binary, so they don’t correspond to any particular time in the galaxy. We’ll see how to convert these to galactic times next.</p>
<div class="admonition-question admonition">
<p class="admonition-title">Question for you</p>
<p>Why are the supernovae times different for primary and secondary stars?</p>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header sd-bg-danger sd-bg-text-danger">
<span class="sd-summary-text">Click here to reveal the answer</span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text">The timing of primary and secondary supernovae is slightly different. Primary supernovae typically occur earlier than secondary supernovae. This is because the primary star is initially more massive and therefore evolves faster, so it reaches the end of its life and explodes as a supernova before the secondary star does. The secondary star may also be affected by mass transfer from the primary, which can alter its evolution and delay its supernova explosion.</p>
</div>
</details></div>
</section>
<section id="compute-the-timing-on-galactic-timescales">
<h3>Compute the timing on Galactic timescales<a class="headerlink" href="#compute-the-timing-on-galactic-timescales" title="Link to this heading">#</a></h3>
<p>Now let’s try converting these times to the galactic frame. Each binary was born at a specific time in the galaxy, which is given by the <a class="reference external" href="https://cogsworth.readthedocs.io/en/latest/api/cogsworth.sfh.StarFormationHistory.html#cogsworth.sfh.StarFormationHistory.tau" title="(in cogsworth)"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tau</span></code></a> attribute of the <a class="reference external" href="https://cogsworth.readthedocs.io/en/latest/api/cogsworth.pop.Population.html#cogsworth.pop.Population.initial_galaxy" title="(in cogsworth)"><code class="xref py py-attr docutils literal notranslate"><span class="pre">initial_galaxy</span></code></a> object. Keep in mind that this is a “lookback time”, so the binary was born <span class="math notranslate nohighlight">\(\tau\)</span> Myr before the present day. So to convert the supernova times to the galactic frame, we can do the following:</p>
<div class="math notranslate nohighlight">
\[t_{\rm gal} = t_{\rm present} - \tau + t_{\rm sn}\]</div>
<p>where <span class="math notranslate nohighlight">\(t_{\rm sn}\)</span> is the time of the supernova in the binary frame and <span class="math notranslate nohighlight">\(t_{\rm present}\)</span> is the present day time in the galaxy (which is 12 Gyr by default, but is stored in the <code class="xref py py-attr docutils literal notranslate"><span class="pre">max_ev_time</span></code> attribute).</p>
<p>Let’s try computing the times of the supernovae in the galactic frame!</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># get the bin_nums of the supernova events</span>
<span class="n">primary_sn_bin_nums</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">bpp</span><span class="p">[</span><span class="s2">&quot;bin_num&quot;</span><span class="p">][</span><span class="n">primary_sn</span><span class="p">]</span>
<span class="n">secondary_sn_bin_nums</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">bpp</span><span class="p">[</span><span class="s2">&quot;bin_num&quot;</span><span class="p">][</span><span class="n">secondary_sn</span><span class="p">]</span>

<span class="c1"># get the indices of these bin_nums in the p.bin_nums array</span>
<span class="n">primary_sn_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">bin_nums</span><span class="p">,</span> <span class="n">primary_sn_bin_nums</span><span class="p">)</span>
<span class="n">secondary_sn_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">bin_nums</span><span class="p">,</span> <span class="n">secondary_sn_bin_nums</span><span class="p">)</span>

<span class="c1"># use these indices to get tau</span>
<span class="n">primary_sn_tau</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">initial_galaxy</span><span class="o">.</span><span class="n">tau</span><span class="p">[</span><span class="n">primary_sn_indices</span><span class="p">]</span>
<span class="n">secondary_sn_tau</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">initial_galaxy</span><span class="o">.</span><span class="n">tau</span><span class="p">[</span><span class="n">secondary_sn_indices</span><span class="p">]</span>

<span class="c1"># compute the galactic times</span>
<span class="n">primary_sn_t_gal</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">max_ev_time</span> <span class="o">-</span> <span class="n">primary_sn_tau</span> <span class="o">+</span> <span class="n">p</span><span class="o">.</span><span class="n">bpp</span><span class="p">[</span><span class="s2">&quot;tphys&quot;</span><span class="p">][</span><span class="n">primary_sn</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">Myr</span>
<span class="n">secondary_sn_t_gal</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">max_ev_time</span> <span class="o">-</span> <span class="n">secondary_sn_tau</span> <span class="o">+</span> <span class="n">p</span><span class="o">.</span><span class="n">bpp</span><span class="p">[</span><span class="s2">&quot;tphys&quot;</span><span class="p">][</span><span class="n">secondary_sn</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">Myr</span>
</pre></div>
</div>
<p>Now let’s take a look at a plot of this</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># use the same bins for both histograms to make it easier to compare</span>
<span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="c1"># plot both as density distributions</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">primary_sn_t_gal</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">Gyr</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Primary SN&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">secondary_sn_t_gal</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">Gyr</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
        <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Secondary SN&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
    <span class="n">xlabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Age of Milky Way at SN, $t_{\rm gal}$ [Gyr]&quot;</span><span class="p">,</span>
    <span class="n">ylabel</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;${\rm}dN/{\rm}dt_{\rm gal}$&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-center" id="id2">
<a class="reference internal image-reference" href="../../../_images/sn_times_galaxy.png"><img alt="Histogram of supernova times in the frame of the galaxy" src="../../../_images/sn_times_galaxy.png" style="width: 80%;" />
</a>
<figcaption>
<p><span class="caption-text">Distribution of supernova times in the frame of the galaxy, with primary and secondary supernovae shown separately.</span><a class="headerlink" href="#id2" title="Link to this image">#</a></p>
</figcaption>
</figure>
<div class="admonition-question admonition">
<p class="admonition-title">Question for you</p>
<p>What drives the distribution of timing of these supernovae on Galactic timescale?</p>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header sd-bg-danger sd-bg-text-danger">
<span class="sd-summary-text">Click here to reveal the answer</span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text">The distributions of primary and secondary supernovae on galactic timescales are quite similar. Most of the supernovae (both primary and secondary) occur on short times in the context of the galaxy, so the main driver of the distribution on galactic timescales is the star formation history of the galaxy.</p>
</div>
</details></div>
</section>
<section id="locate-the-supernovae-in-the-galaxy">
<h3>Locate the supernovae in the galaxy<a class="headerlink" href="#locate-the-supernovae-in-the-galaxy" title="Link to this heading">#</a></h3>
<p>As we’ve seen before, each binary has an <code class="docutils literal notranslate"><span class="pre">orbit</span></code> associated with it, which tracks its trajectory through the galaxy. Let’s take a look at one of these objects to get a sense of what a <code class="docutils literal notranslate"><span class="pre">gala</span></code> <a class="reference external" href="https://gala.adrian.pw/en/latest/api/gala.dynamics.Orbit.html#gala.dynamics.Orbit" title="(in gala v1.11.1.dev34)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Orbit</span></code></a> object looks like.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># let&#39;s take the first orbit</span>
<span class="n">orbit_example</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">orbits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">orbit_example</span><span class="p">)</span>

<span class="c1"># it stores the time and position at each timestep</span>
<span class="nb">print</span><span class="p">(</span><span class="n">orbit_example</span><span class="o">.</span><span class="n">t</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">orbit_example</span><span class="o">.</span><span class="n">pos</span><span class="o">.</span><span class="n">xyz</span><span class="p">)</span>
</pre></div>
</div>
<p>Did you notice that the orbit times end at 12 Gyr? The initial time of the orbit is actually the birth time of the binary in the galaxy, these orbit times are already based in the Galactic frame.</p>
<p>Another complication is that the binary may have disrupted due to a supernova kick, so the secondary may be on a different orbit. <code class="docutils literal notranslate"><span class="pre">cogsworth</span></code> handles this and you can use <code class="docutils literal notranslate"><span class="pre">p.primary_orbits</span></code> and <code class="docutils literal notranslate"><span class="pre">p.secondary_orbits</span></code> to get the orbits of the primary and secondary stars, respectively, at every time step. So make sure to use the correct one for each supernova!</p>
<p>So we need to:</p>
<ul class="simple">
<li><p>Go through each of the supernovae</p></li>
<li><p>Find the corresponding orbit</p></li>
<li><p>Compute the last timestep just before the supernova</p></li>
<li><p>Get the position of the binary at this time</p></li>
</ul>
<p>Let’s do it!</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">primary_sn_positions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">primary_sn</span><span class="p">),</span> <span class="mi">3</span><span class="p">))</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">kpc</span>
<span class="n">secondary_sn_positions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">secondary_sn</span><span class="p">),</span> <span class="mi">3</span><span class="p">))</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">kpc</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">primary_sn_indices</span><span class="p">)):</span>
    <span class="c1"># find the corresponding orbit</span>
    <span class="n">primary_sn_orbit</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">primary_orbits</span><span class="p">[</span><span class="n">primary_sn_indices</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>

    <span class="c1"># compute the last timestep where orbit.t is less than primary_sn_t_gal[i]</span>
    <span class="n">closest_time_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">primary_sn_orbit</span><span class="o">.</span><span class="n">t</span> <span class="o">&lt;</span> <span class="n">primary_sn_t_gal</span><span class="p">[</span><span class="n">i</span><span class="p">])[</span><span class="mi">0</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1"># get the position of the binary at this time</span>
    <span class="n">primary_sn_positions</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">primary_sn_orbit</span><span class="o">.</span><span class="n">pos</span><span class="o">.</span><span class="n">xyz</span><span class="p">[:,</span> <span class="n">closest_time_index</span><span class="p">]</span>

<span class="c1"># same for secondaries</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">secondary_sn_indices</span><span class="p">)):</span>
    <span class="n">secondary_sn_orbit</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">secondary_orbits</span><span class="p">[</span><span class="n">secondary_sn_indices</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
    <span class="n">closest_time_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">secondary_sn_orbit</span><span class="o">.</span><span class="n">t</span> <span class="o">&lt;</span> <span class="n">secondary_sn_t_gal</span><span class="p">[</span><span class="n">i</span><span class="p">])[</span><span class="mi">0</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">secondary_sn_positions</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">secondary_sn_orbit</span><span class="o">.</span><span class="n">pos</span><span class="o">.</span><span class="n">xyz</span><span class="p">[:,</span> <span class="n">closest_time_index</span><span class="p">]</span>
</pre></div>
</div>
<p>And now we can plot the positions of these supernovae in the galaxy!</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="n">gridspec_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;height_ratios&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">]})</span>
<span class="k">for</span> <span class="n">pos</span><span class="p">,</span> <span class="n">times</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
    <span class="p">[</span><span class="n">primary_sn_positions</span><span class="p">,</span> <span class="n">secondary_sn_positions</span><span class="p">],</span>
    <span class="p">[</span><span class="n">primary_sn_t_gal</span><span class="p">,</span> <span class="n">secondary_sn_t_gal</span><span class="p">],</span>
<span class="p">):</span>

    <span class="n">XMAX</span> <span class="o">=</span> <span class="mi">30</span>
    <span class="n">ZMAX</span> <span class="o">=</span> <span class="mf">7.5</span>

    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
        <span class="n">pos</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">pos</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span>
        <span class="n">c</span><span class="o">=</span><span class="n">times</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">Gyr</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
        <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;magma&quot;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">12</span>
    <span class="p">)</span>

    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
        <span class="n">pos</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">pos</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
        <span class="n">c</span><span class="o">=</span><span class="n">times</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">Gyr</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
        <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;magma&quot;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">12</span>
    <span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
    <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;$z$ [kpc]&quot;</span><span class="p">,</span>
    <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="n">XMAX</span><span class="p">,</span> <span class="n">XMAX</span><span class="p">),</span>
    <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="n">ZMAX</span><span class="p">,</span> <span class="n">ZMAX</span><span class="p">),</span>
    <span class="n">aspect</span><span class="o">=</span><span class="s2">&quot;equal&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
    <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Galactocentric $x$ [kpc]&quot;</span><span class="p">,</span>
    <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;Galactocentric $y$ [kpc]&quot;</span><span class="p">,</span>
    <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="n">XMAX</span><span class="p">,</span> <span class="n">XMAX</span><span class="p">),</span>
    <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="n">XMAX</span><span class="p">,</span> <span class="n">XMAX</span><span class="p">),</span>
    <span class="n">aspect</span><span class="o">=</span><span class="s2">&quot;equal&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">collections</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Age of Milky Way at SN [Gyr]&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-center" id="id3">
<a class="reference internal image-reference" href="../../../_images/sn_positions.png"><img alt="Positions of supernovae in the galaxy" src="../../../_images/sn_positions.png" style="width: 80%;" />
</a>
<figcaption>
<p><span class="caption-text">Positions of supernovae in the galaxy. The colour indicates the age of the Milky Way at which the supernova occurs.</span><a class="headerlink" href="#id3" title="Link to this image">#</a></p>
</figcaption>
</figure>
<hr style="margin: 4rem 0;"></section>
</section>
<section id="tasks">
<h2>Tasks<a class="headerlink" href="#tasks" title="Link to this heading">#</a></h2>
<p>Now it’s your turn to do the same for common-envelope events! The code from the demo above should be helpful for this :)</p>
<div class="admonition-task admonition">
<p class="admonition-title">Task 3.1</p>
<p>Create a population like the one above (~10000 binaries, that preferentially samples higher mass binaries). Write a mask for the <code class="docutils literal notranslate"><span class="pre">bpp</span></code> table that selects only the rows corresponding to common-envelope events. It may be useful to know that common-envelope events are labelled as <code class="docutils literal notranslate"><span class="pre">evol_type</span> <span class="pre">==</span> <span class="pre">7</span></code>.</p>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header sd-bg-info sd-bg-text-info">
<span class="sd-summary-text">Hint</span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text">Common-envelope events aren’t specific to an individual star, so you don’t need to keep primary and secondary events separate here, you can just make one mask for all common-envelope events.</p>
</div>
</details><details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header sd-bg-danger sd-bg-text-danger">
<span class="sd-summary-text">Click here to reveal the answer</span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">cogsworth</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">cogsworth</span><span class="o">.</span><span class="n">pop</span><span class="o">.</span><span class="n">Population</span><span class="p">(</span>
    <span class="n">n_binaries</span><span class="o">=</span><span class="mi">10_000</span><span class="p">,</span>
    <span class="n">use_default_BSE_settings</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">final_kstar1</span><span class="o">=</span><span class="p">[</span><span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">],</span>          <span class="c1"># aim to sample systems that produce a NS/BH</span>
    <span class="n">final_kstar2</span><span class="o">=</span><span class="p">[</span><span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">],</span>          <span class="c1"># same for secondary star</span>
<span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">create_population</span><span class="p">()</span>

<span class="n">ce_mask</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">bpp</span><span class="p">[</span><span class="s2">&quot;evol_type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">7</span>
</pre></div>
</div>
</div>
</details></div>
<div class="admonition-task admonition">
<p class="admonition-title">Task 3.2</p>
<p>Now make a histogram that shows the distribution of common-envelope event times in the frame of the binary.</p>
<p>What drives the timing of these common-envelope events?</p>
<p>What would happen if you made a scatter plot of these times against the initial primary mass of the binary? Or the initial orbital period?</p>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header sd-bg-danger sd-bg-text-danger">
<span class="sd-summary-text">Click here to reveal the answer</span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">ce_rows</span><span class="p">[</span><span class="s2">&quot;tphys&quot;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
    <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Time in frame of binary [Myr]&quot;</span><span class="p">,</span>
    <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;Number of common-envelope events&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-center" id="id4">
<a class="reference internal image-reference" href="../../../_images/ce_times_binary.png"><img alt="Histogram of common-envelope event times in the frame of the binary" src="../../../_images/ce_times_binary.png" style="width: 80%;" />
</a>
<figcaption>
<p><span class="caption-text">Distribution of common-envelope event times in the frame of the binary.</span><a class="headerlink" href="#id4" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p class="sd-card-text">A common-envelope event occurs when a star overflows its Roche lobe in an unstable manner. So if we simplify a little, the timing is mainly driven by:</p>
<ol class="loweralpha simple">
<li><p class="sd-card-text">when the star evolves off the main sequence and expands</p></li>
<li><p class="sd-card-text">how far apart the stars are</p></li>
<li><p class="sd-card-text">how large the Roche lobe is (which depends on the mass ratio).</p></li>
</ol>
<p class="sd-card-text">It’s a little more complicated in practice, since the typically stability of mass transfer is different depending on the evolutionary stage of the star when it overflows its Roche lobe (case A, B, or C).</p>
<p class="sd-card-text">But in general, we would expect common-envelope events to occur sooner for higher mass stars since those will expand sooner. We would also expect common-envelope events to be more common and to occur faster for shorter initial orbital periods.</p>
</div>
</details></div>
<div class="admonition-task admonition">
<p class="admonition-title">Task 3.3</p>
<p>Now compute the timing of these common-envelope events in the frame of the galaxy. What drives the distribution of timing of these common-envelope events on Galactic timescale?</p>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header sd-bg-info sd-bg-text-info">
<span class="sd-summary-text">Hint</span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text">Remember that you can convert the common-envelope event times to the galactic frame using the same method as for the common-envelope events.</p>
<p class="sd-card-text">The conversion is given by:</p>
<div class="math notranslate nohighlight">
\[t_{\rm gal} = t_{\rm present} - \tau + t_{\rm ce}\]</div>
<p class="sd-card-text">where <span class="math notranslate nohighlight">\(t_{\rm ce}\)</span> is the time of the common-envelope event in the binary frame and <span class="math notranslate nohighlight">\(t_{\rm present}\)</span> is the present day time in the galaxy (which is 12 Gyr by default, but is stored in the <code class="xref py py-attr docutils literal notranslate"><span class="pre">max_ev_time</span></code> attribute).</p>
</div>
</details><details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header sd-bg-danger sd-bg-text-danger">
<span class="sd-summary-text">Click here to reveal the answer</span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># get the bin_nums of the common-envelope events</span>
<span class="n">ce_bin_nums</span> <span class="o">=</span> <span class="n">ce_rows</span><span class="p">[</span><span class="s2">&quot;bin_num&quot;</span><span class="p">]</span>

<span class="c1"># get the indices of these bin_nums in the p.bin_nums array</span>
<span class="n">ce_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">bin_nums</span><span class="p">,</span> <span class="n">ce_bin_nums</span><span class="p">)</span>

<span class="c1"># use these indices to get tau</span>
<span class="n">ce_tau</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">initial_galaxy</span><span class="o">.</span><span class="n">tau</span><span class="p">[</span><span class="n">ce_indices</span><span class="p">]</span>

<span class="c1"># compute the galactic times</span>
<span class="n">ce_t_gal</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">max_ev_time</span> <span class="o">-</span> <span class="n">ce_tau</span> <span class="o">+</span> <span class="n">ce_rows</span><span class="p">[</span><span class="s2">&quot;tphys&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">Myr</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">ce_t_gal</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">Gyr</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
    <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Age of Milky Way [Gyr]&quot;</span><span class="p">,</span>
    <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;Number of CE events&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-center" id="id5">
<a class="reference internal image-reference" href="../../../_images/ce_times_galaxy.png"><img alt="Histogram of common-envelope event times in the frame of the galaxy" src="../../../_images/ce_times_galaxy.png" style="width: 80%;" />
</a>
<figcaption>
<p><span class="caption-text">Distribution of common-envelope event times in the frame of the galaxy.</span><a class="headerlink" href="#id5" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p class="sd-card-text">The timing in the frame of the binary is relatively short on the scale of the galaxy (most occur within 100 Myr, see earlier plot). So the main driver of the distribution on galactic timescales is the star formation history of the galaxy. In this case, we have a Milky Way-like SFH, which means that most stars (and therefore most common-envelope events) occur early on in the galaxy’s history, which is why we see a peak at early times in the histogram.</p>
</div>
</details></div>
<div class="admonition-task admonition">
<p class="admonition-title">Task 3.4</p>
<p>Last but not least, let’s find the positions of these common-envelope events in the galaxy!</p>
<p>Follow the same method as above to find the positions of these common-envelope events in the galaxy and make a plot of these positions like the one above, though <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> limits of 20 kpc and <span class="math notranslate nohighlight">\(z\)</span> limits of 5 kpc should work well for this. (Why do you think these limits are smaller than for the supernovae plot above?)</p>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header sd-bg-info sd-bg-text-info">
<span class="sd-summary-text">Hint</span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text">Remember that, by definition, the common-envelope event occurs at the same location for both stars, so you can simply use the regular <code class="docutils literal notranslate"><span class="pre">orbits</span></code> array to find the positions of these events.</p>
</div>
</details><details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header sd-bg-danger sd-bg-text-danger">
<span class="sd-summary-text">Click here to reveal the answer</span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ce_positions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">ce_rows</span><span class="p">),</span> <span class="mi">3</span><span class="p">))</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">kpc</span>

<span class="c1"># go through each of the common-envelope events</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ce_indices</span><span class="p">)):</span>
    <span class="c1"># find the corresponding orbit</span>
    <span class="n">ce_orbit</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">orbits</span><span class="p">[</span><span class="n">ce_indices</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>

    <span class="c1"># compute the last timestep where orbit.t is less than ce_t_gal[i]</span>
    <span class="n">closest_time_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ce_orbit</span><span class="o">.</span><span class="n">t</span> <span class="o">&lt;</span> <span class="n">ce_t_gal</span><span class="p">[</span><span class="n">i</span><span class="p">])[</span><span class="mi">0</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1"># get the position of the binary at this time</span>
    <span class="n">ce_positions</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">ce_orbit</span><span class="o">.</span><span class="n">pos</span><span class="o">.</span><span class="n">xyz</span><span class="p">[:,</span> <span class="n">closest_time_index</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="n">gridspec_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;height_ratios&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">]})</span>

<span class="n">XMAX</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">ZMAX</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
    <span class="n">ce_positions</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">ce_positions</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="n">c</span><span class="o">=</span><span class="n">ce_t_gal</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">Gyr</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;magma&quot;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">12</span>
<span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
    <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;$z$ [kpc]&quot;</span><span class="p">,</span>
    <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="n">XMAX</span><span class="p">,</span> <span class="n">XMAX</span><span class="p">),</span>
    <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="n">ZMAX</span><span class="p">,</span> <span class="n">ZMAX</span><span class="p">),</span>
    <span class="n">aspect</span><span class="o">=</span><span class="s2">&quot;equal&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
    <span class="n">ce_positions</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">ce_positions</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="n">c</span><span class="o">=</span><span class="n">ce_t_gal</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">Gyr</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;magma&quot;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">12</span>
<span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
    <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Galactocentric $x$ [kpc]&quot;</span><span class="p">,</span>
    <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;Galactocentric $y$ [kpc]&quot;</span><span class="p">,</span>
    <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="n">XMAX</span><span class="p">,</span> <span class="n">XMAX</span><span class="p">),</span>
    <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="n">XMAX</span><span class="p">,</span> <span class="n">XMAX</span><span class="p">),</span>
    <span class="n">aspect</span><span class="o">=</span><span class="s2">&quot;equal&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">collections</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Age of Milky Way at CE [Gyr]&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-center" id="id6">
<a class="reference internal image-reference" href="../../../_images/ce_positions.png"><img alt="Positions of common-envelope events in the galaxy" src="../../../_images/ce_positions.png" style="width: 80%;" />
</a>
<figcaption>
<p><span class="caption-text">Positions of common-envelope events in the galaxy. The colour indicates the age of the Milky Way at which the common-envelope event occurs.</span><a class="headerlink" href="#id6" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
</details></div>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="part-2.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Part 2: Identifying specific objects in the population</p>
      </div>
    </a>
    <a class="right-next"
       href="part-4.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Part 4: Varying our assumptions</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#demo">Demo</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-population-with-lots-of-massive-stars">Create a population with lots of massive stars</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#find-the-supernovae">Find the supernovae</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inspect-supernova-timing-in-the-frame-of-the-binary">Inspect supernova timing in the frame of the binary</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-the-timing-on-galactic-timescales">Compute the timing on Galactic timescales</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#locate-the-supernovae-in-the-galaxy">Locate the supernovae in the galaxy</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tasks">Tasks</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Tom Wagg
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2026, Tom Wagg.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>