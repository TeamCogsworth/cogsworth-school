
<!DOCTYPE html>


<html lang="en" data-content_root="../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Part 4: Varying our assumptions &#8212; cogsworth school</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../../_static/new_font.css?v=454821b3" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom.css?v=f14441e9" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../../_static/doctools.js?v=fd6eb6e6"></script>
    <script src="../../../_static/sphinx_highlight.js?v=6ffebe34"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script src="../../../_static/design-tabs.js?v=f930bc37"></script>
    <script>window.MathJax = {"tex": {"tags": "ams", "useLabelIds": true}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@4/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'pages/labs/astronuc/part-4';</script>
    <link rel="icon" href="../../../_static/cog.ico"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="prev" title="Part 3: Investigate the supernovae" href="part-3.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/cogsworth-logo.png" class="logo__image only-light" alt=""/>
    <script>document.write(`<img src="../../../_static/cogsworth-logo-darkmode.png" class="logo__image only-dark" alt=""/>`);</script>
  
  
    <p class="title logo__title">cogsworth school</p>
  
</a></div>
        <div class="sidebar-primary-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/TomWagg/cogsworth" title="cogsworth repo" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">cogsworth repo</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://cogsworth.readthedocs.io/" title="cogsworth docs" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-solid fa-book fa-lg" aria-hidden="true"></i>
            <span class="sr-only">cogsworth docs</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/TomWagg/cogsworth/issues/new?template=question.md" title="ask a question" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-solid fa-comment-dots fa-lg" aria-hidden="true"></i>
            <span class="sr-only">ask a question</span></a>
        </li>
</ul></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Background</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../background/start.html">Preparing for the labs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../background/reference.html">Useful reference material</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../background/output.html">Understand your output</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Labs</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../astronuc-index.html">AstroNuc 2026</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="part-1.html">Part 1: Creating your first population</a></li>
<li class="toctree-l2"><a class="reference internal" href="part-2.html">Part 2: Identifying specific objects in the population</a></li>
<li class="toctree-l2"><a class="reference internal" href="part-3.html">Part 3: Investigate the supernovae</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Part 4: Varying our assumptions</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">



<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Part 4: Varying our assumptions</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#demo">Demo</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#initial-population-distributions">Initial population distributions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#binary-physics-settings">Binary physics settings</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#galactic-potential">Galactic potential</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tasks">Tasks</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="part-4-varying-our-assumptions">
<h1>Part 4: Varying our assumptions<a class="headerlink" href="#part-4-varying-our-assumptions" title="Link to this heading">#</a></h1>
<p>In this final part, we are going to do what <em>any</em> good user of population synthesis codes does — vary our assumptions and see how it changes our results!</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>For a full list of the initial conditions and binary physics variations you could use, check out <a class="reference external" href="https://cosmic-popsynth.github.io/COSMIC/pages/inifile.html">this page of the COSMIC docs</a>. Specifically, the sampling parameters are <a class="reference external" href="https://cosmic-popsynth.github.io/COSMIC/pages/inifile.html#sampling">found here</a> and the binary physics parameters are <a class="reference external" href="https://cosmic-popsynth.github.io/COSMIC/pages/inifile.html#binary-physics">here</a>.</p>
</div>
<section id="demo">
<h2>Demo<a class="headerlink" href="#demo" title="Link to this heading">#</a></h2>
<p>Let’s start by quickly creating a template population to use for our variations. At first, let’s just sample the binaries but not do any evolution yet. This will make it easy to use the same initial population for all of our variations, so that we can isolate the impact of changing our assumptions about the physics.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">cogsworth</span>

<span class="n">template</span> <span class="o">=</span> <span class="n">cogsworth</span><span class="o">.</span><span class="n">pop</span><span class="o">.</span><span class="n">Population</span><span class="p">(</span>
    <span class="n">n_binaries</span><span class="o">=</span><span class="mi">10_000</span><span class="p">,</span>
    <span class="n">use_default_BSE_settings</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">final_kstar1</span><span class="o">=</span><span class="p">[</span><span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">],</span>
    <span class="n">final_kstar2</span><span class="o">=</span><span class="p">[</span><span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">template</span><span class="o">.</span><span class="n">sample_initial_binaries</span><span class="p">()</span>
</pre></div>
</div>
<p>We can then copy this template and use it to run a fiducial population.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fiducial</span> <span class="o">=</span> <span class="n">template</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">fiducial</span><span class="o">.</span><span class="n">perform_stellar_evolution</span><span class="p">()</span>
<span class="n">fiducial</span><span class="o">.</span><span class="n">perform_galactic_evolution</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Notice that I didn’t do <code class="docutils literal notranslate"><span class="pre">fiducial.create_population()</span></code> here. This is because I want to have the same initial population for all of my variations, so I just copied the template and then ran the evolution steps separately.</p>
</div>
<p>Now let’s consider some different assumptions that we could vary.</p>
<section id="initial-population-distributions">
<h3>Initial population distributions<a class="headerlink" href="#initial-population-distributions" title="Link to this heading">#</a></h3>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>IMF = Initial Mass Function</p>
</aside>
<p><code class="docutils literal notranslate"><span class="pre">cogsworth</span></code> makes some default assumptions about the initial population distributions. For example, it assumes you want to use an IMF following Kroupa 2001 and the initial orbital period distribution from Sana+2012. You can change these assumptions by changing the parameters in <code class="docutils literal notranslate"><span class="pre">sampling_params</span></code> in the <code class="docutils literal notranslate"><span class="pre">Population</span></code> constructor.</p>
<p>Let’s make a copy of our population and change the orbital period distribution to a custom power law distribution.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># copy the old population</span>
<span class="n">diff_porb</span> <span class="o">=</span> <span class="n">template</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># update sampling parameters and re-run</span>
<span class="n">diff_porb</span><span class="o">.</span><span class="n">sampling_params</span><span class="p">[</span><span class="s2">&quot;porb_model&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mf">0.15</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mf">5.5</span><span class="p">,</span> <span class="s1">&#39;slope&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">}</span>
<span class="n">diff_porb</span><span class="o">.</span><span class="n">create_population</span><span class="p">()</span>
</pre></div>
</div>
<p>Now we can compare the initial orbital period distributions of these two populations.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="mf">0.15</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">fiducial</span><span class="o">.</span><span class="n">initial_binaries</span><span class="p">[</span><span class="s2">&quot;porb&quot;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Sana+2012&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">diff_porb</span><span class="o">.</span><span class="n">initial_binaries</span><span class="p">[</span><span class="s2">&quot;porb&quot;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Custom power law&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
    <span class="n">xscale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span>
    <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Initial orbital period [days]&quot;</span><span class="p">,</span>
    <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;Number of binaries&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-center" id="id1">
<img alt="Initial orbital period distribution comparison" src="../../../_images/vary_init_porb.png" />
<figcaption>
<p><span class="caption-text">The initial orbital period distribution for the two populations.</span><a class="headerlink" href="#id1" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>One can imagine that this change in the initial orbital period distribution could have a significant impact on the properties of the binary population at later times. Let’s see how it changes the number of mergers that occur in our population.</p>
<div class="admonition-question admonition">
<p class="admonition-title">Question for you</p>
<p>Before looking at the results, can you predict how the rate of mergers will change when we switch from the Sana+2012 distribution to our custom power law distribution?</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">pop</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="p">[(</span><span class="n">fiducial</span><span class="p">,</span> <span class="s2">&quot;Sana+2012&quot;</span><span class="p">),</span> <span class="p">(</span><span class="n">diff_porb</span><span class="p">,</span> <span class="s2">&quot;Custom power law&quot;</span><span class="p">)]:</span>
    <span class="n">n_mergers</span> <span class="o">=</span> <span class="p">(</span><span class="n">pop</span><span class="o">.</span><span class="n">final_bpp</span><span class="p">[</span><span class="s2">&quot;sep&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of mergers with </span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s2"> porb distribution:&quot;</span><span class="p">,</span> <span class="n">n_mergers</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="binary-physics-settings">
<h3>Binary physics settings<a class="headerlink" href="#binary-physics-settings" title="Link to this heading">#</a></h3>
<p>There’s also a lot of uncertainty in the physics of binary interactions. It’s therefore important that we vary our assumptions about these interactions to see how they impact our results. For example, we could change the common envelope efficiency parameter, or vary the strength of supernova natal kicks.</p>
<p>Let’s make a copy of our template population, but alter the strength of supernova natal kicks.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">weak_kick</span> <span class="o">=</span> <span class="n">template</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">weak_kick</span><span class="o">.</span><span class="n">BSE_settings</span><span class="p">[</span><span class="s2">&quot;sigma&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">20</span>  <span class="c1"># km/s</span>
<span class="n">weak_kick</span><span class="o">.</span><span class="n">perform_stellar_evolution</span><span class="p">()</span>
<span class="n">weak_kick</span><span class="o">.</span><span class="n">perform_galactic_evolution</span><span class="p">()</span>
</pre></div>
</div>
<p>By decreasing the strength of supernova natal kicks, it’s much less likely that binaries will be disrupted by supernovae. Let’s check that we’re getting fewer disruptions in this population compared to our fiducial population.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">pop</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="p">[(</span><span class="n">fiducial</span><span class="p">,</span> <span class="s2">&quot;Fiducial&quot;</span><span class="p">),</span> <span class="p">(</span><span class="n">weak_kick</span><span class="p">,</span> <span class="s2">&quot;Weak kicks&quot;</span><span class="p">)]:</span>
    <span class="n">n_disrupted</span> <span class="o">=</span> <span class="n">pop</span><span class="o">.</span><span class="n">disrupted</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of disrupted binaries with </span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">,</span> <span class="n">n_disrupted</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition-task admonition">
<p class="admonition-title">Bonus task</p>
<p>Try finding a binary that disrupts in the fiducial population but not in the weak kick population. Plot the orbit of this binary in both populations and see how the different kick strengths lead to different outcomes.</p>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header sd-bg-danger sd-bg-text-danger">
<span class="sd-summary-text">Click here to reveal the answer</span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fid_dis_nums</span> <span class="o">=</span> <span class="n">fiducial</span><span class="o">.</span><span class="n">bin_nums</span><span class="p">[</span><span class="n">fiducial</span><span class="o">.</span><span class="n">disrupted</span><span class="p">]</span>
<span class="n">weak_dis_nums</span> <span class="o">=</span> <span class="n">weak_kick</span><span class="o">.</span><span class="n">bin_nums</span><span class="p">[</span><span class="n">weak_kick</span><span class="o">.</span><span class="n">disrupted</span><span class="p">]</span>

<span class="c1"># find one that is disrupted in fiducial but not in weak_kick</span>
<span class="n">example</span> <span class="o">=</span> <span class="n">weak_kick</span><span class="o">.</span><span class="n">bin_nums</span><span class="p">[</span>
    <span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">weak_kick</span><span class="o">.</span><span class="n">bin_nums</span><span class="p">,</span> <span class="n">fid_dis_nums</span><span class="p">)</span>
    <span class="o">&amp;</span> <span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">weak_kick</span><span class="o">.</span><span class="n">bin_nums</span><span class="p">,</span> <span class="n">weak_dis_nums</span><span class="p">)</span>
<span class="p">][</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># plot both orbits together to see the difference</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">fiducial</span><span class="o">.</span><span class="n">plot_orbit</span><span class="p">(</span><span class="n">example</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">weak_kick</span><span class="o">.</span><span class="n">plot_orbit</span><span class="p">(</span><span class="n">example</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">axes</span><span class="p">,</span> <span class="n">show_legend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># perhaps try changing t_max to look at earlier times?</span>
</pre></div>
</div>
<figure class="align-center" id="id2">
<img alt="Orbit comparison for different kick strengths" src="../../../_images/vary_kick_orbits.png" />
<figcaption>
<p><span class="caption-text">The orbit of a binary that disrupts in the fiducial population but not in the weak kick population.</span><a class="headerlink" href="#id2" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
</details></div>
</section>
<section id="galactic-potential">
<h3>Galactic potential<a class="headerlink" href="#galactic-potential" title="Link to this heading">#</a></h3>
<p>Finally, we could also vary the potential of the galaxy that we are integrating through. In this case, we don’t need to repeat the stellar evolution step, since the galactic potential doesn’t impact the binary interactions (or at least, we are assuming that).</p>
<p>Let’s create a new potential that’s an NFW profile with <span class="math notranslate nohighlight">\(M_{\rm halo} = 10^{12} M_\odot\)</span>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">gala.potential</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">gp</span>

<span class="n">nfw</span> <span class="o">=</span> <span class="n">gp</span><span class="o">.</span><span class="n">NFWPotential</span><span class="p">(</span><span class="n">mhalo</span><span class="o">=</span><span class="mf">1e12</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">Msun</span><span class="p">,</span> <span class="n">r_s</span><span class="o">=</span><span class="mf">15.63</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">kpc</span><span class="p">)</span>

<span class="n">nfw_pop</span> <span class="o">=</span> <span class="n">fiducial</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">nfw_pop</span><span class="o">.</span><span class="n">galactic_potential</span> <span class="o">=</span> <span class="n">nfw</span>
<span class="n">nfw_pop</span><span class="o">.</span><span class="n">perform_galactic_evolution</span><span class="p">()</span>
</pre></div>
</div>
<p>Now let’s compare the orbit of a random binary that disrupts.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">disrupted_num</span> <span class="o">=</span> <span class="n">fiducial</span><span class="o">.</span><span class="n">bin_nums</span><span class="p">[</span><span class="n">fiducial</span><span class="o">.</span><span class="n">disrupted</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="k">for</span> <span class="n">pop</span> <span class="ow">in</span> <span class="p">[</span><span class="n">fiducial</span><span class="p">,</span> <span class="n">nfw_pop</span><span class="p">]:</span>
    <span class="n">pop</span><span class="o">.</span><span class="n">plot_orbit</span><span class="p">(</span><span class="n">disrupted_num</span><span class="p">,</span> <span class="n">t_max</span><span class="o">=</span><span class="mi">2000</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">Myr</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-center" id="id3">
<img alt="Orbit comparison for different galactic potentials" src="../../../_images/vary_gal_pot_orbits_fid.png" />
<figcaption>
<p><span class="caption-text">The orbit of a binary that disrupts in the fiducial population, evolved through the fiducial potential.</span><a class="headerlink" href="#id3" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-center" id="id4">
<img alt="Orbit comparison for different galactic potentials" src="../../../_images/vary_gal_pot_orbits_nfw.png" />
<figcaption>
<p><span class="caption-text">The same binary as the previous figure, but evolved through the NFW potential we created.</span><a class="headerlink" href="#id4" title="Link to this image">#</a></p>
</figcaption>
</figure>
<hr style="margin: 4rem 0;"></section>
</section>
<section id="tasks">
<h2>Tasks<a class="headerlink" href="#tasks" title="Link to this heading">#</a></h2>
<p>You’ll not have time to do all of these tasks in the lab, so just pick whichever one looks more interesting to you (and no one’s stopping you doing the others later!).</p>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="part-3.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Part 3: Investigate the supernovae</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#demo">Demo</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#initial-population-distributions">Initial population distributions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#binary-physics-settings">Binary physics settings</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#galactic-potential">Galactic potential</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tasks">Tasks</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Tom Wagg
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2026, Tom Wagg.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>